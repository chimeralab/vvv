<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<html><head>
<link rel="stylesheet" href="stap.css"></link>

<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBtfGeqBIXdFmaFkmjY004cvb3SWOKyy-c",
    authDomain: "vvve-56dc2.firebaseapp.com",
    databaseURL: "https://vvve-56dc2.firebaseio.com",
    projectId: "vvve-56dc2",
    storageBucket: "vvve-56dc2.appspot.com",
    messagingSenderId: "441698672673"
  };
  firebase.initializeApp(config);
</script>

<!-- <script src="https://rawgit.com/vdv7/stapjs/master/stap.js"></script> -->
<script src="stap.js"></script>
<script>

var datasetOrder=['Practice Trials','Batch 1','Batch 2','Batch 3','Batch 4'];
var nextButtons=['Experimental Trials','Batch 2','Batch 3','Batch 4','Submit'];

var TIME_ON_SHIPLEY = 300;

var myHighlights ={
'Practice Trials':[0,3,4],
'Batch 1':[11,15,18,22,23,24,30,32,36,39],
'Batch 2':[3,4,10,14,19,25,35,38,48,49],
'Batch 3':[2,8,22,40,42,52,53,69,76,78],
'Batch 4':[1,2,13,17,25,30,39,56,67,95]
};


var datasets={

	'Practice Trials':[
				["11:18",69,"Russia","FTP - Suspicious MGET Command"],
				["21:50",513,"Chile","Suspicious Browser Redirect"],
				["12:12",80,"China","FTP CWD Root directory transversal attempt"],
				["4:20",42,"Hungary","FTP - Suspicious MGET Command"],
				["19:26",9898,"China","ET TROJAN Qhosts Trojan Check-in"]
	],
	
	'Batch 1':[
				["1:25",7,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["3:26",7,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["3:26",42,"China","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["5:43",6257,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["3:52",69,"Russia","FTP - Suspicious MGET Command"],
				["2:12",6666,"China","ET TROJAN Sality Variant Downloader Activity"],
				["0:11",500,"India","INFO web virus 0x0 gif attempt"],
				["3:35",42,"China","INFO Connection Closed MSG from Suspicious Port"],
				["3:14",5554,"Chile","ET TROJAN Sality Variant Downloader Activity"],
				["1:59",443,"Chile","Javascript Exploit CVE-2012-09-10a"],
				["5:32",69,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["0:53",21,"Chile","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["5:39",5234,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["5:32",53,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:55",3222,"Russia","NETBIOS SMB-DS winreg access"],
				["18:54",5234,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["3:24",9119,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["5:32",5554,"Russia","FTP CWD Root directory virus attempt"],
				["2:17",80,"Russia","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["1:37",5554,"China","INFO web virus 0x0 gif attempt"],
				["5:26",5554,"China","Chat Encrypted Yahoo IM Message"],
				["1:35",6666,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["2:19",563,"China","INFO web virus 0x0 gif attempt"],
				["8:42",53,"China","IRC Command, Control, and Scanning Tool Download"],
				["3:25",6257,"Russia","Suspicious Browser Redirect"],
				["3:48",6666,"Romania","Rar Encrypted File Transfer"],
				["2:54",5554,"China","FTP CWD Root directory virus attempt"],
				["3:20",9119,"Russia","INFO web virus 0x0 gif attempt"],
				["3:35",70,"Russia","Chat Encrypted Yahoo IM Message"],
				["24:13",7,"India","Rar Encrypted File Transfer"],
				["1:41",7,"United States","MULTIMEDIA Quicktime User Agent exploit"],
				["5:12",42,"Russia","FTP STOR overflow attempt.exploit"],
				["1:46",443,"China","INFO web virus 0x0 gif attempt"],
				["4:17",5234,"Russia","FTP Satan Scan"],
				["4:17",6257,"China","FTP STOR overflow attempt.exploit"],
				["3:32",80,"China","ET TROJAN Sality Variant Checkin Activity"],
				["0:31",1863,"United States","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["9:43",7,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["1:24",443,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:55",9119,"Hungary","ET TROJAN Sality Variant Downloader Activity"]
	],
	
	'Batch 2':[
			["0:44",42,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["4:22",7,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["9:25",21,"Russia","WEB-CGI webspeed access"],
				["0:59",5234,"China","ET TROJAN Sality Variant Downloader Activity"],
				["2:26",6257,"Russia","Chat Encrypted Yahoo IM Message"],
				["6:52",80,"Russia","INFO web virus 0x0 gif attempt"],
				["17:50",9119,"China","IRC Command, Control, and Scanning Tool Download"],
				["0:46",443,"Hungary","INFO Connection Closed MSG from Suspicious Port"],
				["0:44",9119,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["6:35",6257,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["2:25",69,"Russia","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["5:54",9119,"Russia","Chat Encrypted Yahoo IM Message"],
				["4:31",6257,"China","FTP STOR overflow attempt.exploit"],
				["5:54",70,"China","Suspicious Browser Redirect"],
				["7:40",6257,"China","INFO Connection Closed MSG from Suspicious Port"],
				["1:44",7,"China","ET TROJAN Sality Variant Downloader Activity"],
				["16:32",80,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["3:24",70,"China","Chat Encrypted Yahoo IM Message"],
				["5:34",6257,"China","FTP CWD Root directory virus attempt"],
				["12:45",9119,"Russia","FTP STOR overflow attempt"],
				["3:28",5098,"China","Chat Encrypted Yahoo IM Message"],
				["4:53",21,"Romania","Javascript Exploit CVE-2012-09-10a"],
				["5:18",53,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["10:12",21,"United States","Suspicious Browser Redirect"],
				["5:30",563,"Chile","INFO Connection Closed MSG from Suspicious Port"],
				["5:19",53,"Canada","Javascript Exploit CVE-2012-09-10a"],
				["2:10",70,"China","FTP STOR overflow attempt"],
				["3:56",70,"China","FTP STOR overflow attempt.exploit"],
				["3:24",9119,"Russia","XMLHttpRequest attempt"],
				["5:20",21,"China","FTP - Suspicious MGET Command"],
				["2:36",80,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["4:14",6257,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["5:30",5098,"China","Javascript Exploit CVE-2012-09-10a"],
				["5:40",21,"Thailand","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["2:53",5554,"China","Chat Encrypted Yahoo IM Message"],
				["2:53",7,"United States","MULTIMEDIA Quicktime User Agent exploit"],
				["3:42",21,"Russia","Chat Encrypted Yahoo IM Message"],
				["4:39",5234,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["10:17",2302,"Russia","FTP CWD Root directory virus attempt"],
				["2:54",5554,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["23:13",6666,"United States","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["2:28",5234,"Russia","Chat Encrypted Yahoo IM Message"],
				["5:18",80,"China","ET TROJAN Qhosts Trojan Check-in"],
				["5:31",42,"China","FTP STOR overflow attempt.exploit"],
				["1:44",53,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["11:16",80,"China","Javascript Exploit CVE-2012-09-10a"],
				["22:18",5098,"Russia","IRC Command, Control, and Scanning Tool Download"],
				["0:50",5554,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["20:14",6257,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["12:45",1755,"China","FTP CWD Root directory virus attempt"],
				["0:23",70,"Russia","Suspicious Browser Redirect"],
				["4:50",69,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["2:25",5554,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["2:43",5098,"China","Chat Encrypted Yahoo IM Message"],
				["5:49",9119,"Russia","FTP STOR overflow attempt.exploit"],
				["5:13",6666,"China","Chat Encrypted Yahoo IM Message"],
				["4:39",5098,"Russia","FTP - Suspicious MGET Command"],
				["3:48",21,"Russia","ET TROJAN Qhosts Trojan Check-in"],
				["5:58",69,"United States","MULTIMEDIA Quicktime User Agent exploit"],
				["3:41",7,"Russia","FTP STOR overflow attempt"]
	],
	
	'Batch 3':[
				["1:46",70,"Russia","NETBIOS SMB-DS winreg access"],
				["2:22",5554,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["1:22",6666,"Russia","FTP CWD Root directory virus attempt"],
				["3:52",69,"Russia","FTP - Suspicious MGET Command"],
				["1:25",70,"Russia","Rar Encrypted File Transfer"],
				["0:52",53,"Russia","Chat Encrypted Yahoo IM Message"],
				["2:31",80,"Russia","Rar Encrypted File Transfer"],
				["11:30",6257,"Russia","XMLHttpRequest attempt"],
				["1:31",21,"China","FTP CWD Root directory virus attempt"],
				["18:42",139,"Russia","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:14",5098,"China","FTP CWD Root directory virus attempt"],
				["1:58",995,"Russia","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["11:30",443,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["1:24",21,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["1:59",6666,"Thailand","WEB-CGI webspeed access"],
				["4:51",990,"China","FTP STOR overflow attempt.exploit"],
				["13:13",70,"Chile","INFO Connection Closed MSG from Suspicious Port"],
				["3:35",70,"Russia","Suspicious Browser Redirect"],
				["3:35",70,"Russia","Chat Encrypted Yahoo IM Message"],
				["5:37",7,"China","FTP CWD Root directory virus attempt"],
				["19:39",9119,"China","Javascript Exploit CVE-2012-09-10a"],
				["1:57",69,"Russia","Suspicious Browser Redirect"],
				["4:31",42,"United States","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["5:32",70,"Russia","Chat Encrypted Yahoo IM Message"],
				["0:35",6666,"United States","WEB-CGI webspeed access"],
				["1:24",7,"China","FTP STOR overflow attempt.exploit"],
				["9:43",69,"China","Javascript Exploit CVE-2012-09-10a"],
				["16:47",5098,"Russia","FTP STOR overflow attempt"],
				["1:42",70,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["3:48",70,"Russia","Suspicious Browser Redirect"],
				["2:26",5554,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["1:29",53,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["3:26",42,"China","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["4:39",42,"China","Rar Encrypted File Transfer"],
				["22:10",80,"China","FTP CWD Root directory virus attempt"],
				["4:40",80,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["3:35",6666,"China","FTP CWD Root directory virus attempt"],
				["2:47",69,"China","Javascript Exploit CVE-2012-09-10a"],
				["9:39",70,"United States","Chat Encrypted Yahoo IM Message"],
				["1:20",500,"Russia","ET TROJAN Sality Variant Checkin Activity"],
				["1:14",5554,"Russia","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["0:25",7,"Russia","Suspicious Browser Redirect"],
				["4:52",7,"Hungary","FTP - Suspicious MGET Command"],
				["3:35",42,"China","INFO Connection Closed MSG from Suspicious Port"],
				["1:55",42,"China","FTP STOR overflow attempt.exploit"],
				["2:54",5554,"China","FTP CWD Root directory virus attempt"],
				["0:25",53,"Russia","Suspicious Browser Redirect"],
				["2:22",80,"China","FTP STOR overflow attempt.exploit"],
				["2:44",443,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["4:31",3074,"Russia","NETBIOS SMB-DS winreg access"],
				["0:47",42,"Thailand","FTP CWD Root directory virus attempt"],
				["2:12",5554,"Russia","INFO web virus 0x0 gif attempt"],
				["1:20",42,"China","IRC Command, Control, and Scanning Tool Download"],
				["2:54",80,"India","Rar Encrypted File Transfer"],
				["2:12",21,"China","INFO web virus 0x0 gif attempt"],
				["5:32",42,"Russia","WEB-CGI webspeed access"],
				["12:15",5554,"China","INFO web virus 0x0 gif attempt"],
				["5:32",9119,"China","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["4:29",53,"Russia","FTP - Suspicious MGET Command"],
				["1:29",5234,"Russia","Chat Encrypted Yahoo IM Message"],
				["3:26",7,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["1:51",80,"Canada","FTP CWD Root directory virus attempt"],
				["5:27",5234,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["2:26",6257,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["3:25",5234,"Thailand","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["1:37",69,"Russia","FTP STOR overflow attempt.exploit"],
				["1:37",5554,"China","INFO web virus 0x0 gif attempt"],
				["3:32",6257,"Russia","FTP CWD Root directory virus attempt"],
				["4:29",53,"China","ET TROJAN Sality Variant Checkin Activity"],
				["0:53",5554,"Romania","MULTIMEDIA Quicktime User Agent exploit"],
				["3:23",80,"China","FTP Satan Scan"],
				["9:39",6666,"Russia","XMLHttpRequest attempt"],
				["5:32",443,"China","ET TROJAN Sality Variant Checkin Activity"],
				["1:37",70,"Russia","Rar Encrypted File Transfer"],
				["5:37",6257,"Russia","FTP STOR overflow attempt"],
				["14:36",53,"India","INFO Connection Closed MSG from Suspicious Port"],
				["16:47",80,"China","Suspicious Browser Redirect"],
				["5:43",6666,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["0:19",5554,"Canada","ET TROJAN Sality Variant Checkin Activity"],
				["5:12",42,"Russia","FTP STOR overflow attempt.exploit"]
	],
	
	'Batch 4':[
				["21:11",21,"Romania","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["1:51",80,"Canada","FTP CWD Root directory virus attempt"],
				["2:26",6257,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["21:27",4664,"China","Javascript Exploit CVE-2012-09-10a"],
				["1:24",6257,"China","WEB-CGI webspeed access"],
				["3:46",5098,"China","FTP - Suspicious MGET Command"],
				["0:11",9119,"Russia","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["0:37",9119,"China","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["3:17",5234,"Russia","FTP CWD Root directory virus attempt"],
				["23:21",53,"Canada","Javascript Exploit CVE-2012-09-10a"],
				["1:25",7,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["4:21",5234,"China","NETBIOS SMB-DS winreg access"],
				["3:20",9119,"Russia","INFO web virus 0x0 gif attempt"],
				["1:57",990,"Russia","FTP STOR overflow attempt.exploit"],
				["2:26",5554,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["5:39",5234,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["14:24",42,"China","FTP STOR overflow attempt.exploit"],
				["1:37",443,"China","Rar Encrypted File Transfer"],
				["3:35",70,"Russia","Suspicious Browser Redirect"],
				["3:35",6666,"China","FTP CWD Root directory virus attempt"],
				["5:32",69,"Russia","INFO web virus 0x0 gif attempt"],
				["3:12",7,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["12:23",69,"China","IRC Command, Control, and Scanning Tool Download"],
				["0:37",69,"Russia","FTP CWD Root directory virus attempt"],
				["0:31",42,"China","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["1:25",21,"India","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:57",69,"Russia","Suspicious Browser Redirect"],
				["0:25",53,"Russia","Suspicious Browser Redirect"],
				["3:46",69,"China","FTP - Suspicious MGET Command"],
				["2:30",53,"Thailand","Javascript Exploit CVE-2012-09-10a"],
				["0:53",5554,"Russia","WEB-CGI webspeed access"],
				["2:25",5554,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["1:41",7,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["24:34",5554,"China","FTP STOR overflow attempt"],
				["4:39",42,"China","Rar Encrypted File Transfer"],
				["0:53",70,"Romania","Javascript Exploit CVE-2012-09-10a"],
				["1:24",21,"Canada","ET TROJAN Sality Variant Checkin Activity"],
				["0:52",4664,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["19:39",9119,"China","Javascript Exploit CVE-2012-09-10a"],
				["4:27",6666,"Hungary","IRC Command, Control, and Scanning Tool Download"],
				["2:54",5554,"Russia","Suspicious Browser Redirect"],
				["1:29",5098,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["0:25",7,"Russia","Suspicious Browser Redirect"],
				["18:18",443,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["20:47",80,"China","Suspicious Browser Redirect"],
				["3:48",70,"China","Rar Encrypted File Transfer"],
				["2:47",69,"China","Javascript Exploit CVE-2012-09-10a"],
				["2:44",70,"Canada","ET TROJAN Sality Variant Downloader Activity"],
				["3:45",3222,"Thailand","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["3:26",69,"China","INFO web virus 0x0 gif attempt"],
				["0:30",9119,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["1:20",563,"China","Chat Encrypted Yahoo IM Message"],
				["5:43",5234,"Hungary","FTP STOR overflow attempt.exploit"],
				["3:14",5098,"China","NETBIOS SMB-DS winreg access"],
				["2:31",7,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["2:19",2745,"Chile","MULTIMEDIA Quicktime User Agent exploit"],
				["11:15",443,"China","INFO web virus 0x0 gif attempt"],
				["3:24",9119,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["5:26",5554,"United States","INFO Connection Closed MSG from Suspicious Port"],
				["22:10",80,"China","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["0:37",9119,"India","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["3:25",6257,"Russia","Suspicious Browser Redirect"],
				["1:23",6257,"United States","MULTIMEDIA Quicktime User Agent exploit"],
				["1:24",21,"Russia","MULTIMEDIA Quicktime User Agent exploit"],
				["5:32",53,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:31",2784,"Russia","Suspicious Browser Redirect"],
				["1:24",7,"China","FTP STOR overflow attempt.exploit"],
				["0:18",80,"Russia","IRC Command, Control, and Scanning Tool Download"],
				["4:40",7,"Russia","FTP STOR overflow attempt.exploit"],
				["1:25",70,"Russia","Rar Encrypted File Transfer"],
				["0:25",21,"China","FTP - Suspicious MGET Command"],
				["3:20",3074,"Thailand","MULTIMEDIA Quicktime User Agent exploit"],
				["3:52",69,"Russia","FTP - Suspicious MGET Command"],
				["0:34",21,"Russia","Chat Encrypted Yahoo IM Message"],
				["3:35",42,"China","INFO Connection Closed MSG from Suspicious Port"],
				["1:29",443,"Russia","NETBIOS SMB-DS winreg access"],
				["3:48",9119,"Russia","XMLHttpRequest attempt"],
				["3:35",80,"Thailand","FTP - Suspicious MGET Command"],
				["5:12",9119,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["3:13",69,"Russia","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["2:54",80,"United States","INFO web virus 0x0 gif attempt"],
				["5:43",6666,"Russia","INFO Connection Closed MSG from Suspicious Port"],
				["1:31",7,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:59",80,"China","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["14:24",80,"Russia","Suspicious Browser Redirect"],
				["16:47",80,"China","Suspicious Browser Redirect"],
				["4:17",5554,"China","INFO web virus 0x0 gif attempt"],
				["1:58",21,"Hungary","INFO Connection Closed MSG from Suspicious Port"],
				["1:35",6666,"China","MULTIMEDIA Quicktime User Agent exploit"],
				["9:39",4672,"China","ET TROJAN Sality - Encrypted Opera User-Agent"],
				["15:32",5554,"Thailand","INFO Connection Closed MSG from Suspicious Port"],
				["0:49",6257,"China","ET TROJAN W32/Sality Executable Pack Digital Signature ASCII Marker"],
				["4:52",5098,"Russia","ET TROJAN Virus.Win32.Sality.aa Checkin"],
				["1:57",5098,"Russia","XMLHttpRequest attempt"],
				["11:13",6666,"Romania","INFO web virus 0x0 gif attempt"],
				["1:42",70,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["1:14",5098,"China","FTP CWD Root directory virus attempt"],
				["3:35",70,"China","FTP CWD Root directory virus attempt"],
				["1:42",70,"Russia","Javascript Exploit CVE-2012-09-10a"],
				["2:44",5098,"India","ET TROJAN Virus.Win32.Sality.aa Checkin"]	
	]
};



function shuffleBatches() {
	var a=['Batch 1','Batch 2','Batch 3','Batch 4']
	var j, x, i;
	for (i = a.length - 1; i > 0; i--) {
		j = Math.floor(Math.random() * (i + 1));
		x = datasets[a[i]];
		datasets[a[i]] = datasets[a[j]];
		datasets[a[j]] = x;
		x = myHighlights[a[i]];
		myHighlights[a[i]] = myHighlights[a[j]];
		myHighlights[a[j]] = x;
	}
}


function button(name,enabled){
	var b={['@'+name]:false};
	if(enabled!==undefined)b.eB=enabled;
	return b;
}



var task = {
	
	////////////////////////
	/////// CONSENT! ///////
	////////////////////////
	start: function(){
	    shuffleBatches();
		task.updateUI( {
			template:"clairescratch.css",
			require:{ options:['T','R','title','eT','select','head','patronym','scroll','time','emp'], types:['table'] },
			client:["userAgent","screen"],
			date:(new Date()).toString('YYYYMDhhmmss')
		} );
		task.updateUI(["<h1>Informed Consent Agreement</h1>",
			"Please read this consent agreement carefully before you decide to participate in the study.",
			"Purpose of the research study: The purpose of the study is to investigate how humans recognize patterns of interest.",
			"What you will do in the study: If you choose to participate in this study, you will be asked to identify malicious versus benign patterns in a series of datasets using pre-established rules. The information you provide is anonymous and you are free to stop the experiment at any time.",
			"Time required: The study will require about 25-30 minutes of your time.",
			"Risks: There are no risks associated with this study. The information you will provide is not sensitive and a loss of confidentiality poses no threats.",
			"Benefits: There are no direct benefits to you for participating in this research study. The study may help us understand what factors impair pattern recognition.",
			"Confidentiality: Participant data will be stored on Amazon Firebase, a secure cloud-based platform. Only mTurk-assigned worker IDs---which consist of random characters (e.g. A1235875436)---will be stored for payment purposes. No personally identifying information (e.g., names, emails, addresses) will be collected. The information that you give in the study will be handled confidentially. Your data will be anonymous which means that your name will not be collected or linked to the data.",
			"Voluntary participation: Your participation in the study is completely voluntary.",		
			"Right to withdraw from the study: You have the right to withdraw from the study at any time without penalty. How to withdraw from the study: If you want to withdraw from the study, you may simply close the study. There is no penalty for withdrawing. You will still receive full credit for the study. If you would like to withdraw after your materials have been submitted, please contact Claire La Fleur (claire.g.lafleur.ctr@mail.mil).",	
			"Payment: You will receive a base payment of $1.50 for participating in the study. Score above 70% and you will receive a bonus of $1.50!",	
			"If you have questions about the study, contact:",	
			"Claire-Genevieve La Fleur (claire.g.lafleur.ctr@mail.mil)",	
			"Bldg. 519, Aberdeen Proving Ground",	
			"U.S. Army Research Laboratory, Aberdeen, MD 21005",						
			button("I Consent") ]);
	},

	/////////////////////////////////
	/////// ALL OTHER SCREENS ///////
	/////////////////////////////////
	userAction: function(time,element,value){
		console.log(time,element,value);
		

		////////////////////////////////////
		/////   SHIPLEYS INSTRUCTIONS  /////
		////////////////////////////////////
		if(element=='I Consent'){
			task.updateUI(null);
			task.updateUI(["<h1>Shipley's Abstractions</h1>", "Fill in the missing letter, number, or word to complete each sequence. Write only one character in each blank space.", "<p class='redtext'>YOU WILL HAVE FIVE MINUTES TO COMPLETE THE TASK<\p>"
				, button("Begin Task") 
			]);
		}
		
	
		
		/////////////////////////////
		/////   SHIPLEYS TASK   /////
		/////////////////////////////
		if(element=='Begin Task'){
			task.updateUI(null);
			task.updateUI([
				{"@floatBar":[
					{'@Time Remaining':TIME_ON_SHIPLEY,'time':'m:s'}, 
					{'@Time Remaining':0,'T':TIME_ON_SHIPLEY,'R':4},
					{'@Instructions':"Fill in the missing letter,<br> number, or word to complete each<br> sequence. Write only one character <br> in each blank space."},
					{"@Complete":false}
				], title:''}
			]);
		task.updateUI([   {'@Shipley':[
			["Pattern", "Answer Here (*'s = # of Letters/Numbers Needed)"],
			['1 2 3 4 5 _',{"@":"*",eT:2}], 
			['White black short long down _ _',{"@":"**",eT:2}],
			['AB BC CD D_',{"@":"*",eT:2}],  
			['Z Y X W V U _',{"@":"*",eT:2}],
			['1 2 3 2 1 2 3 4 3 2 3 4 5 4 3 4 5 6 _ _',{"@":"**",eT:2}],
			['NE/SW SE/NW E/W N/ _',{"@":"*",eT:2}],  
			['Escape scape cape _ _ _',{"@":"***",eT:2}],  
			['Oh ho rat tar mood _ _ _ _',{"@":"****",eT:2}],  
			['A Z B Y C X D _ _',{"@":"**",eT:2}],  
			['Tot tot bard drab 537 _ _ _',{"@":"***",eT:2}],  
			['Mist is wasp as pint in tone’ _ _',{"@":"**",eT:2}],  
			['57326 73265 32657 26573 _ _ _ _ _',{"@":"*****",eT:2}],  
			['Knit in spud up both to stay _ _',{"@":"**",eT:2}],  
			['Scotland landscape scape goat  _ _ _ _ ee',{"@":"****",eT:2}],  
			['Surgeon 1234567 snore 17635 rogue _ _ _ _ _',{"@":"*****",eT:2}],  
			['Tam tan rib rid rat raw hip _ _ _',{"@":"***",eT:2}],
			['Tar pitch throw saloon bar rod fee tip end plank _ _ _ _ _ meals',{"@":"*****",eT:2}],  
			['3124 82 73 154 46 13 _',{"@":"*",eT:2}],  
			['Lag leg pen pin big bog rob _ _ _',{"@":"***",eT:2}],  
			['Two w four r one o three _',{"@":"*",eT:2}]
				] , type:'table', head:1,select:1,patronym:1, scroll:1
				}])	
		}
			
		

		////////////////////////
		///// INSTRUCTIONS /////
		////////////////////////
		if(element=='Complete' || element=='Time Remaining'){
			task.updateUI(null);
			task.updateUI(["<h1>Instructions</h1>",
				"In the following task, will see several tables, or batches, that contain a series of cyber events - some of them are benign and some represent potential threats. Your job is to identify all the events in each batch that represent a credible cyber threat using the rules provided", "RULES: You will be shown a set of rules at the top of the screen for each batch. If a particular event meet the criteria for a threat as described in the rules, then you should mark it as a concern. When you have identified all the credible threats in a batch, click submit at the top of the screen to move on to the next batch.", "HINTS: Some of the events will be highlighted; these are events that an automated intrusion detection system has identified as suspicious activity; the performance of the IDS is ALWAYS better than chance", "<p class='redtext'>The rules and the accuracy of the intrusion detection system MAY CHANGE between batches.<p class='redtext'>", "You have unlimited time to complete the task.<br><br>"
				, button("Practice Trials") 
			]);
		}
		
		///////////////////////////////////////////////	
		///////    Reminder of Instructions!    ///////	
		///////////////////////////////////////////////	
		else  if(element=='Experimental Trials'){
			task.updateUI(null);
			task.updateUI(["<h1>Instructions Reminder</h1>",
				"You've completed your practice trials! As a reminder, you will see several tables, or batches, that contain a series of cyber events - some of them are benign and some represent potential threats. Your job is to identify all the events in each batch that represent a credible cyber threat using the rules provided", "RULES: You will be shown a set of rules at the top of the screen for each batch. If a particular event meet the criteria for a threat as described in the rules, then you should mark it as a concern. When you have identified all the credible threats in a batch, click submit at the top of the screen to move on to the next batch.", "HINTS: Some of the events will be highlighted; these are events that an automated intrusion detection system has identified as suspicious activity; the performance of the IDS is ALWAYS better than chance", "<p class='redtext'>The rules and the accuracy of the intrusion detection system MAY CHANGE between batches.<p class='redtext'>", "You have unlimited time to complete the task.<br><br>"
				, button("Batch 1") 
			]);
		}
		
		
		////////////////////////
		////// DEBRIEFING //////
		////////////////////////
		else if(element=='Submit'){
			task.updateUI(null);
			task.updateUI([{'@Your MTurk validation number is':(new Date()).getTime()}])
			task.updateUI(["<h1>Debriefing</h1>", 
				"To effectively defend against cyber security threats, one must consider both the technological and human dimensions (Von Solms, 2013; Kraemer, 2009). The defense analyst performs a crucial role by anticipating, understanding, and coordinating an efficient and successful response to ongoing cyber threats. This study was concerned with how certain qualities of the data environment make a cyber defenders job more difficult. In the present experiment, we were interesting in evaluating out how increasing the amount of information to process, decreasing the time to make a decision, decreasing the veracity of the information presented, and increasing the variety of information available impacted your ability to identify threatening patterns in a batch of cyber events. In our future work, we hope to develop agents to help reduce the impacts of these factors on the human cyber defender.",
				"Our hope is to better understand how these factors impact cyber defender performance so that we can assist soldiers in identifying and eliminating cyber threats. If you are interested in reading more about this type of work, please review the following citations.",
				"What is I want to know more?",
				"Buchler, N., Fitzhugh, S. M., Marusich, L. R., Ungvarsky, D. M., Lebiere, C., & Gonzalez, C. (2016). Mission command in the age of network-enabled operations: Social network analysis of information sharing and situation awarenss. Frontiers in Psychology, 7, 1-15. ", 
				"Kraemer, S., Carayon, P., & Clem, J. (2009). Human and organization factor in computer and information security: Pathways to vulnerabilities. Computers & Security, 28, 509-520. ",
				"If you have any concerns with your rights as a participant in this experiment, please contact Claire La Fleur, Primary Investigator, Army Research Lab at 410-306-1249 or (claire.g.lafleur.ctr@mail.mil)",
				"Thank you again for your participation."
			]);
			////////////////////////
			///// FINISH TASK! /////		
			////////////////////////
			task.end();
		}

		//////////////////////
		///// ALL TRIALS /////
		//////////////////////
		else  if(element in datasets){
			task.nextButton=nextButtons[datasetOrder.indexOf(element)];
			task.currentResponses=new Array(datasets[element].length);
			task.updateUI(null);
			task.updateUI([
				{"@floatBar":[
					{'@':["<p class='yellowhighlight'>HIGHLIGHTED EVENTS ARE IDENTIFIED AS THREATS<br><br>BY AN INTRUSTION DETECTION SYSTEM. HOWEVER, <br><br>  <strong>THESE IDENTIFICATIONS MAY NOT BE ACCURATE.<\p>"]},
					{'@':["<p class='redtext'>EVENTS ARE THREATS IF THEY <br>MEET ALL FOUR CRITERIA:<\p>",
						"1. Time Stamp between 0:00 and 5:00 hours",
						"2. Source Port < 80 or > 5,000",
						"3. Destination Countries: Russia, China",
						"4. Alerts including suspicious, encrypted, exploit, and virus"
					]},
					button(task.nextButton,0)
				], title:''}, 
				{['@'+element]:[
				["Time Stamp","Source Port","Destination Countries","Alert","Threat","No Threat"], 
				] , type:'table', head:1,patronym:1, scroll:1}
			]);

			for(var i=0;i<datasets[element].length;++i){
				console.log([i, myHighlights[element], myHighlights[element].indexOf(i)] );
				task.updateUI([   {['@'+element]:
					[ task.formatRow(datasets[element][i], myHighlights[element].indexOf(i) ) ] 
				}]);
			}
		}
		
		//added 5 lines below; also added line 506 to create the task.currentResponses array; also changed the button to be disabled to start, and enabled when all responses are there
		else if(task.currentResponses && element.constructor===Array){		//
			task.currentResponses[element[1]-1]=value;
			if(Math.min.apply(null,task.currentResponses)===1)
				task.updateUI([{"@floatBar":[button(task.nextButton,1)]}]);
			else
				task.updateUI([{"@floatBar":[button(task.nextButton,0)]}]);
		}
		
		
		
	},
	
	// add two radio buttons to each displayed record
	formatRow:function(rec,highlight){
		console.log(highlight);
		rec.push(button(''));
		rec.push(button(''));
		return {'@':rec,select:1,emp:(highlight>-1)?10:0};;
	}
	
}

logToFirebase();

</script>
</head><body /></html>
